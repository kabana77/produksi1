ield;
    QBrowseQTY_LPB2: TFloatField;
    QRDBText26: TQRDBText;
    QRDBText32: TQRDBText;
    QRDBText35: TQRDBText;
    QRDBText14: TQRDBText;
    QBrowseQTY_LPB: TFloatField;
    TabSheet3: TTabSheet;
    Panel10: TPanel;
    GroupBox2: TGroupBox;
    Label17: TLabel;
    vTglAwal20: TwwDBDateTimePicker;
    vTglAkhir20: TwwDBDateTimePicker;
    Panel11: TPanel;
    vOperand20: TLabel;
    cbTanggal20: TCheckBox;
    BitBtn3: TBitBtn;
    ECari20: TEdit;
    cbOtomatis20: TCheckBox;
    dbcField20: TwwDBComboBox;
    wwDBGrid20: TwwDBGrid;
    QBrowse20: TOracleDataSet;
    QBrowse20TANGGAL: TDateTimeField;
    QBrowse20NO_NOTA: TStringField;
    QBrowse20STATUS_NOTA: TStringField;
    QBrowse20KD_ITEM: TStringField;
    QBrowse20NAMA_ITEM: TStringField;
    QBrowse20SATUAN: TStringField;
    QBrowse20BAGIAN: TStringField;
    QBrowse20SUB_BAGIAN: TStringField;
    QBrowse20TGL_KBTHN: TDateTimeField;
    QBrowse20TGL_PP: TDateTimeField;
    QBrowse20TGL_PO: TDateTimeField;
    QBrowse20TGL_LPB: TDateTimeField;
    QBrowse20LEAD_PP: TFloatField;
    QBrowse20LEAD_PO: TFloatField;
    QBrowse20LEAD_LPB: TFloatField;
    QBrowse20LEAD_KBTHN: TFloatField;
    QBrowse20QTY_KBTHN: TFloatField;
    QBrowse20QTY_PO: TFloatField;
    QBrowse20QTY_LPB: TFloatField;
    QBrowse20STATUS: TStringField;
    QBrowse20NO_PP: TStringField;
    QBrowse20NO_PO: TStringField;
    QBrowse20NO_LPB: TStringField;
    dsQBrowse2: TwwDataSource;
    QBrowse20REKANAN: TStringField;
    QRLabel37: TQRLabel;
    QJnsTransaksiDOC_ISO: TStringField;
    QRDBText39: TQRDBText;
    TabSheet4: TTabSheet;
    QBrowse200: TOracleDataSet;
    QBrowse200KD_TRANSAKSI: TStringField;
    QBrowse200TANGGAL: TDateTimeField;
    QBrowse200NO_NOTA: TStringField;
    QBrowse200KD_ITEM: TStringField;
    QBrowse200NAMA_ITEM: TStringField;
    QBrowse200SATUAN: TStringField;
    QBrowse200BAGIAN: TStringField;
    QBrowse200SUB_BAGIAN: TStringField;
    QBrowse200TGL_KBTHN: TDateTimeField;
    QBrowse200TGL_PP: TDateTimeField;
    QBrowse200TGL_PO: TDateTimeField;
    QBrowse200TGL_LPB: TDateTimeField;
    QBrowse200LEAD_PP: TFloatField;
    QBrowse200LEAD_PO: TFloatField;
    QBrowse200LEAD_LPB: TFloatField;
    QBrowse200LEAD_KBTHN: TFloatField;
    QBrowse200QTY_KBTHN: TFloatField;
    QBrowse200QTY_PO: TFloatField;
    QBrowse200QTY_LPB: TFloatField;
    QBrowse200REKANAN: TStringField;
    QBrowse200NO_PP: TStringField;
    QBrowse200NO_PO: TStringField;
    QBrowse200NO_LPB: TStringField;
    dsQBrowse200: TwwDataSource;
    Panel12: TPanel;
    GroupBox3: TGroupBox;
    Label18: TLabel;
    vTglAwal200: TwwDBDateTimePicker;
    vTglAkhir200: TwwDBDateTimePicker;
    Panel13: TPanel;
    vOperand200: TLabel;
    cbTanggal200: TCheckBox;
    BitBtn4: TBitBtn;
    ECari200: TEdit;
    cbOtomatis200: TCheckBox;
    dbcField200: TwwDBComboBox;
    wwDBGrid200: TwwDBGrid;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormCreate(Sender: TObject);
    procedure wwDBGrid1TitleButtonClick(Sender: TObject;
      AFieldName: String);
    procedure wwDBGrid2TitleButtonClick(Sender: TObject;
      AFieldName: String);
    procedure LookKonstruksiEnter(Sender: TObject);
    procedure cbTanggalClick(Sender: TObject);
    procedure QTransaksiAfterPost(DataSet: TDataSet);
    procedure wwDBGrid2Enter(Sender: TObject);
    procedure QTransaksiNewRecord(DataSet: TDataSet);
    procedure QTransaksiBeforePost(DataSet: TDataSet);
    procedure TabSheet2Show(Sender: TObject);
    procedure QDetailNewRecord(DataSet: TDataSet);
    procedure QTransaksiBeforeInsert(DataSet: TDataSet);
    procedure QTransaksiBeforeEdit(DataSet: TDataSet);
    procedure DBText1Click(Sender: TObject);
    procedure DBText2Click(Sender: TObject);
    procedure BitBtn2Click(Sender: TObject);
    procedure LookBagianCloseUp(Sender: TObject; LookupTable,
      FillTable: TDataSet; modified: Boolean);
    procedure LookItemEnter(Sender: TObject);
    procedure QLookItemBeforeOpen(DataSet: TDataSet);
    procedure LookBagianEnter(Sender: TObject);
    procedure LookItemCloseUp(Sender: TObject; LookupTable,
      FillTable: TDataSet; modified: Boolean);
    procedure wwDBGrid2CalcCellColors(Sender: TObject; Field: TField;
      State: TGridDrawState; Highlight: Boolean; AFont: TFont;
      ABrush: TBrush);
    procedure wwDBGrid1DblClick(Sender: TObject);
    procedure ECariChange(Sender: TObject);
    procedure cbOtomatisClick(Sender: TObject);
    procedure BitBtn1Click(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure QBrowseBeforeOpen(DataSet: TDataSet);
    procedure TitleBand1BeforePrint(Sender: TQRCustomBand;
      var PrintBand: Boolean);
    procedure BitBtn5Click(Sender: TObject);
    procedure QLookSubBagianBeforeOpen(DataSet: TDataSet);
    procedure TabSheet1Show(Sender: TObject);
    procedure QBrowseAfterScroll(DataSet: TDataSet);
    procedure TitleBand2BeforePrint(Sender: TQRCustomBand;
      var PrintBand: Boolean);
    procedure FormCloseQuery(Sender: TObject; var CanClose: Boolean);
    procedure QDetailBeforeInsert(DataSet: TDataSet);
    procedure QTransaksiAfterDelete(DataSet: TDataSet);
    procedure DetailBand2BeforePrint(Sender: TQRCustomBand;
      var PrintBand: Boolean);
    procedure VTglAwalChange(Sender: TObject);
    procedure vTglAkhirChange(Sender: TObject);
    procedure QDetailBeforePost(DataSet: TDataSet);
    procedure RadioGroup1Click(Sender: TObject);
    procedure ColumnHeaderBand2BeforePrint(Sender: TQRCustomBand;
      var PrintBand: Boolean);
    procedure wwDBGrid2DblClick(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure vHeightAfterUpClick(Sender: TObject);
    procedure BtnExportClick(Sender: TObject);
    procedure DBText5Click(Sender: TObject);
    procedure dbcFieldEnter(Sender: TObject);
    procedure vOperandClick(Sender: TObject);
    procedure Label3Click(Sender: TObject);
    procedure QBrowseCalcFields(DataSet: TDataSet);
    procedure BitBtn3Click(Sender: TObject);
    procedure TabSheet3Show(Sender: TObject);
    procedure dbcField20Enter(Sender: TObject);
    procedure vOperand20Click(Sender: TObject);
    procedure ECari20Change(Sender: TObject);
    procedure cbOtomatis20Click(Sender: TObject);
    procedure vTglAwal20Change(Sender: TObject);
    procedure vTglAkhir20Change(Sender: TObject);
    procedure cbTanggal20Click(Sender: TObject);
    procedure QBrowse200BeforeOpen(DataSet: TDataSet);
    procedure TabSheet4Show(Sender: TObject);
    procedure vTglAwal200Change(Sender: TObject);
    procedure vTglAkhir200Change(Sender: TObject);
    procedure cbOtomatis200Click(Sender: TObject);
    procedure dbcField200Enter(Sender: TObject);
    procedure vOperand200Click(Sender: TObject);
    procedure cbTanggal200Click(Sender: TObject);
    procedure ECari200Change(Sender: TObject);
    procedure BitBtn4Click(Sender: TObject);
    procedure wwDBGrid200TitleButtonClick(Sender: TObject;
      AFieldName: String);

  private
    { Private declarations }
    vfilter, vorder, vfilter2, vfilter20, vorder20, vfilter200, vorder200 : String;
  public
    { Public declarations }
    vkd_jns_item, vkd_bag : String;
    vhak_input, vkg_change, vbale_change : Boolean;
    vrecord_ke : integer;
  end;

var
  KebutuhanBBBenangFrm: TKebutuhanBBBenangFrm;

implementation

uses DM, MainBrowse, Main, Menus, XPROCS, DateUtils, Math, Keterangan,
  Sisdur;

{$R *.dfm}

procedure TKebutuhanBBBenangFrm.FormClose(Sender: TObject;
  var Action: TCloseAction);
begin
  Action:=caFree;
  KebutuhanBBBenangFrm:=Nil;
end;

procedure TKebutuhanBBBenangFrm.FormCreate(Sender: TObject);
begin
  DMFrm.QLookSubBagian.Close;
  QLookItem.Close;
end;

procedure TKebutuhanBBBenangFrm.wwDBGrid1TitleButtonClick(Sender: TObject;
  AFieldName: String);
begin
  if ((Sender as TwwDBGrid).ColumnByName(AFieldName).FieldName<>'') then
  begin
     if (Sender as TwwDBGrid).DataSource.DataSet.FieldByName(AFieldName).FieldKind=fkData then
        begin
          if vorder=' ASC' then
              vorder:=' DESC'
          else
              vorder:=' ASC';
          (Sender as TwwDBGrid).DataSource.DataSet.DisableControls;
          (Sender as TwwDBGrid).DataSource.DataSet.Close;
          ((Sender as TwwDBGrid).DataSource.DataSet as TOracleDataSet).SetVariable('myparam',vfilter+' order by '+(Sender as TwwDBGrid).ColumnByName(AFieldName).FieldName+vorder);
          (Sender as TwwDBGrid).DataSource.DataSet.Open;
          (Sender as TwwDBGrid).DataSource.DataSet.EnableControls;
        end
        else
          ShowMessage('Maaf, tidak bisa diurutkan menurut '+AFieldName+' !');
  end
  else
  ShowMessage('Maaf, tidak bisa diurutkan menurut '+AFieldName+' !');

end;

procedure TKebutuhanBBBenangFrm.wwDBGrid2TitleButtonClick(Sender: TObject;
  AFieldName: String);
begin
  if ((Sender as TwwDBGrid).ColumnByName(AFieldName).FieldName<>'') then
  begin
     if (Sender as TwwDBGrid).DataSource.DataSet.FieldByName(AFieldName).FieldKind=fkData then
        begin
          if vorder=' ASC' then
              vorder:=' DESC'
          else
              vorder:=' ASC';
          (Sender as TwwDBGrid).DataSource.DataSet.DisableControls;
          (Sender as TwwDBGrid).DataSource.DataSet.Close;
          ((Sender as TwwDBGrid).DataSource.DataSet as TOracleDataSet).SetVariable('myparam',vfilter2+' order by '+(Sender as TwwDBGrid).ColumnByName(AFieldName).FieldName+vorder);
          (Sender as TwwDBGrid).DataSource.DataSet.Open;
          (Sender as TwwDBGrid).DataSource.DataSet.EnableControls;
        end
        else
          ShowMessage('Maaf, tidak bisa diurutkan menurut '+AFieldName+' !');
  end
  else
  ShowMessage('Maaf, tidak bisa diurutkan menurut '+AFieldName+' !');

end;

procedure TKebutuhanBBBenangFrm.LookKonstruksiEnter(Sender: TObject);
begin
  DMFrm.QKonstruksi.Open;
end;

